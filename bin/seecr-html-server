#!/usr/bin/env python
# vim: syntax=py #

from os.path import abspath, dirname                #DO_NOT_DISTRIBUTE
from os import system, getcwd                       #DO_NOT_DISTRIBUTE
from glob import glob                               #DO_NOT_DISTRIBUTE
from sys import path as systemPath, exit            #DO_NOT_DISTRIBUTE
if getcwd() != dirname(abspath(__file__)):          #DO_NOT_DISTRIBUTE
    print 'Run from directory:',                    #DO_NOT_DISTRIBUTE
    print dirname(abspath(__file__))                #DO_NOT_DISTRIBUTE
    exit(1)                                         #DO_NOT_DISTRIBUTE
system('find .. -name "*.pyc" | xargs rm -f')       #DO_NOT_DISTRIBUTE
for path in glob('../deps.d/*'):                    #DO_NOT_DISTRIBUTE
    systemPath.insert(0, path)                      #DO_NOT_DISTRIBUTE
systemPath.insert(0, '..')                          #DO_NOT_DISTRIBUTE

from meresco.components import ParseArguments
from seecr.html.server import startServer

if __name__ == '__main__':
    parser = ParseArguments()
    parser.addOption('', '--port', type='int', help='Port number', default=8000)
    parser.addOption('', '--dynamic', help='Directory for dynamic files', mandatory=True)
    parser.addOption('', '--static', help='Directory for static files', mandatory=True)
    parser.addOption('', '--index', help="Default dynamic file", default="/index")
    parser.addOption('', '--staticpath', help="HTTP path for static files", default="/static")
    parser.addOption('', '--dynpath', help="HTTP path for dynamic files", default="/")

    options, arguments = parser.parse()

    startServer(**vars(options))
